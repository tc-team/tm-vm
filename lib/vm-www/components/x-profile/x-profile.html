<polymer-element name="x-profile">
    <template>
        <link rel="stylesheet" href="css/style.css">

        <core-ajax id="getProfile"
            auto
            url="http://localhost:3000/user"
            method="GET"
            handleAs="json"
            withCredentials="true"
            on-core-response="{{handleResGetProff}}">
        </core-ajax>

        <core-ajax id="setEmail"
            auto="false"
            url="http://localhost:3000/user"
            method="PUT"
            params = '{
                "newEmail": "{{newEmail}}"
            }'
            handleAs="json"
            withCredentials="true"
            on-core-response="{{handleResSetEmail}}">
        </core-ajax>

        <core-ajax id="createToken"
            auto="false"
            url="http://localhost:3000/token"
            method="POST"
            handleAs="json"
            withCredentials="true"
            on-core-response="{{handleResCreateTok}}">
        </core-ajax>

        <core-ajax id="deleteUser"
            auto="false"
            url="http://localhost:3000/user"
            method="DELETE"
            handleAs="json"
            withCredentials="true"
            on-core-response="{{handleResDelUser}}">
        </core-ajax>
        
        <core-toolbar>
            Profile
        </core-toolbar>
        
    
        <div class="profile" horizontal layout center>
            <span>Username</span>
            <span>{{user.username}}</span>
        </div>

        <div class="profile" horizontal layout center>
            <span>Email</span>
            <span>{{user.email}}</span>

            <core-icon icon="mode-edit" on-click="{{toggleEmail}}"></core-icon>
            <core-collapse id="collapseEmail">
                <h3>Email:</h3>
                <paper-input-decorator floatingLabel label="{{user.email}}">
                    <input id="email" is="core-input" type="email" value="{{newEmail}}" autofocus></input>
                    <core-icon icon="save" on-click="{{changeEmail}}"></core-icon>
                </paper-input-decorator>
            </core-collapse>
        </div>

        <div class="profile" horizontal layout center>
            <span>Password</span>
            <span>
                <paper-button raised on-click="{{createToken}}">Change password</paper-button>
            </span>
            <core-collapse id="collapsePassword">
                <p>Email with instructions has been sent to {{user.email}}</p>
            </core-collapse>
        </div>
        
        <h2>Product</h2>
        <div class="products">
            <span>Memo</span>
            <span>Number</span>
        </div>


    </template>

    <script src="js/script.js"></script>
</polymer-element>